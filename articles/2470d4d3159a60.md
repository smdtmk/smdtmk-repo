---
title: "AWS CDKã§VPCã‚’ä½œæˆã—ã¦ã¿ãŸ"
emoji: "ğŸŒŠ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [aws,cdk,vpc]
published: true
---

## ã¯ã˜ã‚ã«
å‹‰å¼·ã®ãŸã‚AWS CDKã‚’ä½¿ã£ã¦VPCå‘¨ã‚Šã®ãƒªã‚½ãƒ¼ã‚¹ã‚’ä½œæˆã—ã¦ã¿ã¾ã—ãŸã€‚
L2ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’ä½¿ã†ã¨ãƒªã‚½ãƒ¼ã‚¹åãŒåˆ¶å¾¡ã§ããªã„ï¼ˆå¤šåˆ†ï¼‰ã®ã§L1ã¨ä¸€ç·’ã«æ··ãœã¦ä½¿ã„ã¾ã™ã€‚

## å…ˆã«çµè«–
L1ã‚’ä½¿ã†ã¨è¨˜è¿°ãŒå¢—ãˆã‚‹åˆ†ç´°ã‹ã„åˆ¶å¾¡ãŒå¯èƒ½ã«ãªã‚‹ã®ã§ã‚ˆã‚Šæ¥­å‹™ã«ä½¿ã„ã‚„ã™ããªã‚‹ã¨æ€ã„ã¾ã—ãŸã€‚
â€»å¢—ãˆã‚‹ã¨è¨€ã£ã¦ã‚‚CloudFormationã‚ˆã‚Šã¯çŸ­ãè¨˜è¿°ã§ãã¾ã™ã€‚

## ç’°å¢ƒ
- Mac
- Vscode
- AmazonQ (TypeScriptåˆå¿ƒè€…ã®ãŸã‚GithubCopilotã®ã‚ˆã†ã«ä½¿ã£ã¦ã¾ã™)

## å®Œæˆäºˆæƒ³å›³
![](/images/2470d4d3159a60_1.drawio.png)


## ã‚³ãƒ¼ãƒ‰
```typescript:lib/vpc-stack.ts
import * as cdk from 'aws-cdk-lib';
import { Construct } from 'constructs';
import * as ec2 from 'aws-cdk-lib/aws-ec2';

export class VpcStack extends cdk.Stack {
  constructor(scope: Construct, id: string, props?: cdk.StackProps) {
    super(scope, id, props);

    //VPC
    //ã€ŒsubnetConfigurationã€ã‚’ç©ºã«ã™ã‚‹ã“ã¨ã§ä½™è¨ˆãªãƒªã‚½ãƒ¼ã‚¹ã‚’ä½œæˆã—ãªã„
    const vpc = new cdk.aws_ec2.Vpc(this, 'VPC', {
      vpcName: 'CDK-VPC',
      ipAddresses: ec2.IpAddresses.cidr('10.10.0.0/16'),
      subnetConfiguration: []
    });

    //IGW
    const igw = new ec2.CfnInternetGateway(this, 'IGW', {
      tags: [{key: 'Name',value: 'CDK-IGW'}]
    });

    //Attach IGW
    const attachGateway = new ec2.CfnVPCGatewayAttachment(this, 'VPCAttachment', {
      vpcId: vpc.vpcId,
      internetGatewayId: igw.ref
    });

    //Public Subnet
    const public_subnet = new ec2.CfnSubnet(this, 'SubnetPublic', {
      vpcId: vpc.vpcId,
      cidrBlock: '10.10.10.0/24',
      tags: [{key: 'Name',value: 'CDK-Public'}]
    });

    //Public RouteTable
    const public_table = new ec2.CfnRouteTable(this, 'PublicRouteTable', {
      vpcId: vpc.vpcId,
      tags: [{key: 'Name',value: 'CDK-Public-Table'}]
    });

    //IGW Rote
    const igw_route = new ec2.CfnRoute(this, 'PublicRoute', {
      routeTableId: public_table.ref,
      destinationCidrBlock: '0.0.0.0/0',
      gatewayId: igw.ref
    });

    //Public Route Association
    const public_assoc = new ec2.CfnSubnetRouteTableAssociation(this, 'PublicAssoc', {
      subnetId: public_subnet.ref,
      routeTableId: public_table.ref
    });
  }
}
```

## å‚è€ƒ
https://catalog.workshops.aws/typescript-and-cdk-for-beginner/ja-JP/20-typescript-basic
https://blog.future.ad.jp/aws-cdk-v2-%E3%81%A7vpc%E3%82%92%E8%87%AA%E5%88%86%E5%A5%BD%E3%81%BF%E3%81%AB-%E3%81%9D%E3%81%AE%E3%81%AB

## ãŠã‚ã‚Šã«
CDKã®æ–¹ãŒå®šç¾©ã®ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ãŒå¤šã„ã®ã§å­¦ç¿’ã‚³ã‚¹ãƒˆãŒé«˜ã„åˆ†ä½¿ãˆã‚‹ã‚ˆã†ã«ãªã‚Œã°
è‰²ã€…ä¾¿åˆ©ãªã®ã‹ãªã¨æ€ã„ã¾ã—ãŸã€‚æ¬¡ã¯EC2ç­‰ã‚‚ä½œã£ã¦ã¿ã‚ˆã†ã¨æ€ã„ã¾ã™ã€‚